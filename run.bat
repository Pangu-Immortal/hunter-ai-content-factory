@echo off
chcp 65001 >nul
setlocal enabledelayedexpansion

:: â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
:: Hunter AI å†…å®¹å·¥åŽ‚ - Windows é›¶é…ç½®ä¸€é”®å¯åŠ¨è„šæœ¬
::
:: ç‰¹ç‚¹ï¼š
:: - ç©ºç™½ç”µè„‘åŒå‡»å³å¯è¿è¡Œï¼Œæ— éœ€ä»»ä½•é¢„è£…çŽ¯å¢ƒ
:: - è‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£… uv åŒ…ç®¡ç†å™¨ï¼ˆåˆ°é¡¹ç›®ç›®å½•ï¼‰
:: - è‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£… Python 3.12ï¼ˆç”± uv ç®¡ç†ï¼‰
:: - è‡ªåŠ¨å®‰è£…é¡¹ç›®ä¾èµ–
:: - å¯åŠ¨ Gradio Web UI å¹¶è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
::
:: GitHub: https://github.com/Pangu-Immortal/hunter-ai-content-factory
:: Author: Pangu-Immortal
:: â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

title Hunter AI å†…å®¹å·¥åŽ‚ - åˆå§‹åŒ–ä¸­...

:: åˆ‡æ¢åˆ°è„šæœ¬æ‰€åœ¨ç›®å½•
cd /d "%~dp0"

:: è®¾ç½®æœ¬åœ°è·¯å¾„
set "LOCAL_UV=%~dp0.local\uv"
set "UV_EXE=%LOCAL_UV%\uv.exe"
set "PATH=%LOCAL_UV%;%PATH%"

echo.
echo  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo  â•‘                                                           â•‘
echo  â•‘     ðŸ¦… Hunter AI å†…å®¹å·¥åŽ‚                                 â•‘
echo  â•‘                                                           â•‘
echo  â•‘     ä¸€é”®ç”Ÿæˆé«˜è´¨é‡å…¬ä¼—å·æ–‡ç« çš„ AI å·¥ä½œæµ                  â•‘
echo  â•‘                                                           â•‘
echo  â•‘     é¦–æ¬¡è¿è¡Œéœ€è¦ä¸‹è½½çŽ¯å¢ƒï¼Œè¯·è€å¿ƒç­‰å¾…...                   â•‘
echo  â•‘                                                           â•‘
echo  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

:: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
:: Step 1: æ£€æŸ¥/å®‰è£… uvï¼ˆæœ¬åœ°å®‰è£…ï¼Œä¸æ±¡æŸ“ç³»ç»Ÿï¼‰
:: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo [1/6] æ£€æŸ¥ uv åŒ…ç®¡ç†å™¨...

:: é¦–å…ˆæ£€æŸ¥æœ¬åœ° uv
if exist "%UV_EXE%" (
    echo    âœ… æœ¬åœ° uv å·²å­˜åœ¨
    goto :check_python
)

:: æ£€æŸ¥ç³»ç»Ÿ uv
where uv >nul 2>&1
if %errorlevel% equ 0 (
    echo    âœ… ç³»ç»Ÿ uv å·²å®‰è£…
    set "UV_EXE=uv"
    goto :check_python
)

:: ä¸‹è½½å¹¶å®‰è£… uv åˆ°æœ¬åœ°ç›®å½•
echo    â³ æ­£åœ¨ä¸‹è½½ uv åŒ…ç®¡ç†å™¨...
echo       ï¼ˆé¦–æ¬¡è¿è¡Œï¼Œè¯·ç¨å€™çº¦ 1-2 åˆ†é’Ÿï¼‰

:: åˆ›å»ºæœ¬åœ°ç›®å½•
if not exist "%LOCAL_UV%" mkdir "%LOCAL_UV%"

:: ä½¿ç”¨ PowerShell ä¸‹è½½ uv
powershell -ExecutionPolicy Bypass -Command ^
    "$ProgressPreference = 'SilentlyContinue'; " ^
    "try { " ^
    "    $url = 'https://github.com/astral-sh/uv/releases/latest/download/uv-x86_64-pc-windows-msvc.zip'; " ^
    "    $zip = '%TEMP%\uv.zip'; " ^
    "    $dest = '%LOCAL_UV%'; " ^
    "    Write-Host '       ä¸‹è½½ä¸­...'; " ^
    "    Invoke-WebRequest -Uri $url -OutFile $zip -UseBasicParsing; " ^
    "    Write-Host '       è§£åŽ‹ä¸­...'; " ^
    "    Expand-Archive -Path $zip -DestinationPath $dest -Force; " ^
    "    Remove-Item $zip -Force; " ^
    "    Write-Host '       å®Œæˆ!'; " ^
    "} catch { " ^
    "    Write-Host 'ä¸‹è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿žæŽ¥'; " ^
    "    exit 1; " ^
    "}"

if not exist "%UV_EXE%" (
    echo.
    echo âŒ uv ä¸‹è½½å¤±è´¥ï¼
    echo    è¯·æ£€æŸ¥ç½‘ç»œè¿žæŽ¥ï¼Œæˆ–æ‰‹åŠ¨ä¸‹è½½ï¼š
    echo    https://github.com/astral-sh/uv/releases
    echo.
    pause
    exit /b 1
)

echo    âœ… uv ä¸‹è½½å®Œæˆ

:check_python
:: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
:: Step 2: æ£€æŸ¥/å®‰è£… Pythonï¼ˆç”± uv ç®¡ç†ï¼‰
:: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo.
echo [2/6] æ£€æŸ¥ Python çŽ¯å¢ƒ...

:: ä½¿ç”¨ uv æ£€æŸ¥å¹¶å®‰è£… Python
"%UV_EXE%" python find 3.12 >nul 2>&1
if %errorlevel% neq 0 (
    echo    â³ æ­£åœ¨ä¸‹è½½ Python 3.12...
    echo       ï¼ˆé¦–æ¬¡è¿è¡Œï¼Œè¯·ç¨å€™çº¦ 2-3 åˆ†é’Ÿï¼‰
    "%UV_EXE%" python install 3.12 --quiet
    if %errorlevel% neq 0 (
        echo.
        echo âŒ Python ä¸‹è½½å¤±è´¥ï¼
        echo    è¯·æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
        echo.
        pause
        exit /b 1
    )
)

for /f "tokens=*" %%i in ('"%UV_EXE%" python find 3.12 2^>nul') do set PYTHON_PATH=%%i
echo    âœ… Python 3.12 å°±ç»ª

:: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
:: Step 3: æ£€æŸ¥é…ç½®æ–‡ä»¶
:: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo.
echo [3/6] æ£€æŸ¥é…ç½®æ–‡ä»¶...

if not exist "config.yaml" (
    if exist "config.example.yaml" (
        echo    â³ åˆ›å»ºé…ç½®æ–‡ä»¶...
        copy "config.example.yaml" "config.yaml" >nul
        echo    âœ… å·²åˆ›å»º config.yaml
        echo.
        echo    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        echo    âš ï¸ é‡è¦æç¤ºï¼šé¦–æ¬¡è¿è¡Œè¯·å…ˆé…ç½® API Keyï¼
        echo.
        echo       1. ç”¨è®°äº‹æœ¬æ‰“å¼€é¡¹ç›®ç›®å½•ä¸‹çš„ config.yaml
        echo       2. å¡«å†™ gemini.api_keyï¼ˆå¿…å¡«ï¼Œä»Ž Google AI Studio èŽ·å–ï¼‰
        echo       3. å…¶ä»–é…ç½®å¯é€‰å¡«
        echo    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        echo.
    ) else (
        echo    âš ï¸ æœªæ‰¾åˆ°é…ç½®æ–‡ä»¶æ¨¡æ¿
    )
) else (
    echo    âœ… config.yaml å·²å­˜åœ¨
)

:: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
:: Step 4: å®‰è£…ä¾èµ–
:: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo.
echo [4/6] å®‰è£…é¡¹ç›®ä¾èµ–...

:: ä½¿ç”¨ uv åŒæ­¥ä¾èµ–ï¼ˆå¼ºåˆ¶ä½¿ç”¨ uv ç®¡ç†çš„ Pythonï¼‰
"%UV_EXE%" sync --python-preference only-managed --quiet 2>nul
if %errorlevel% neq 0 (
    echo    â³ é¦–æ¬¡å®‰è£…ä¾èµ–ï¼Œè¯·ç¨å€™...
    "%UV_EXE%" sync --python-preference only-managed
    if %errorlevel% neq 0 (
        echo.
        echo âŒ ä¾èµ–å®‰è£…å¤±è´¥ï¼
        echo    è¯·æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
        echo.
        pause
        exit /b 1
    )
)
echo    âœ… ä¾èµ–å·²å®‰è£…

:: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
:: Step 5: å®‰è£… Playwright æµè§ˆå™¨ï¼ˆç”¨äºŽå°çº¢ä¹¦é‡‡é›†ï¼‰
:: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo.
echo [5/6] æ£€æŸ¥æµè§ˆå™¨é©±åŠ¨...

:: æ£€æŸ¥æ˜¯å¦å·²å®‰è£… Playwright æµè§ˆå™¨ï¼ˆé™é»˜å®‰è£…ï¼‰
"%UV_EXE%" run --python-preference only-managed playwright install chromium >nul 2>&1
echo    âœ… æµè§ˆå™¨é©±åŠ¨å°±ç»ª

:: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
:: Step 6: å¯åŠ¨ Gradio
:: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo.
echo [6/6] å¯åŠ¨ Web UI...

title Hunter AI å†…å®¹å·¥åŽ‚ - è¿è¡Œä¸­

echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo    ðŸš€ Hunter AI æ­£åœ¨å¯åŠ¨...
echo.
echo    æœ¬åœ°è®¿é—®:    http://localhost:7860
echo    å±€åŸŸç½‘è®¿é—®:  http://ä½ çš„IP:7860
echo    å¤–é“¾åˆ†äº«:    å¯åŠ¨åŽä¼šæ˜¾ç¤ºå…¬ç½‘é“¾æŽ¥
echo.
echo    âš¡ æµè§ˆå™¨å°†è‡ªåŠ¨æ‰“å¼€ï¼Œå¦‚æžœæ²¡æœ‰è¯·æ‰‹åŠ¨è®¿é—®ä¸Šè¿°åœ°å€
echo.
echo    æŒ‰ Ctrl+C åœæ­¢æœåŠ¡
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

:: å»¶è¿Ÿæ‰“å¼€æµè§ˆå™¨ï¼ˆç­‰å¾…æœåŠ¡å¯åŠ¨ï¼‰
start "" cmd /c "timeout /t 5 /nobreak >nul && start http://localhost:7860"

:: å¯åŠ¨ Gradioï¼ˆä½¿ç”¨æ¨¡å—åŒ– UIï¼‰
"%UV_EXE%" run --python-preference only-managed python -m src.gradio_launcher

:: å¦‚æžœå¼‚å¸¸é€€å‡º
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo    æœåŠ¡å·²åœæ­¢
echo    æŒ‰ä»»æ„é”®å…³é—­çª—å£...
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
pause >nul
